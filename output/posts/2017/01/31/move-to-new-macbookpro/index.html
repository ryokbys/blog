
<!DOCTYPE html>
<html lang="ja">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="../../../../../theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="../../../../../theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="../../../../../theme/font-awesome/css/font-awesome.min.css">


    <link href="http://ryokbys.web.nitech.ac.jp/contents/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="R.K.S. blog Atom">



  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content="Ryo KOBAYASHI" />
<meta name="description" content="移行アシスタントは使えなかった． 旧Mac（MacBookAir）と接続して，直接移行することをトライ．（一回目は，MBAの方はEl Capitanだったが，二回目はアップグレードしてSeirra同士での移行） なぜだか最後，残り1時間40分から先に進めなくなる． ２回やってどちらもほぼ同じ症状（再現性あり）なので，ダメなのだろう． ということで，否応無く__手動インストール__を余儀なくされた． macOS sierraのクリーンインストール Cmd+rを押しながら起動．アップルマークが表示されたらCmd+rを離して良いみたい． ディスクユーティリティを開いてディスクを消去およびフォーマット OSの再インストール これ自体は時間は少々かかるが，スムーズに進む． Xcode App Storeからダウンロード． 一度Xcodeを起動して認証(?)しないと，のちのhomebrewインストールで引っかかる． Terminal.appの設定 Solarized から，ファイルをダウンロード． Terminal.appの環境設定「プロファイル」で，「読み込み...」からsolarizedの「Light」と「Dark …" />
<meta name="keywords" content="mac">
<meta property="og:site_name" content="R.K.S. blog"/>
<meta property="og:title" content="新しいMacBookProへの移行の記録"/>
<meta property="og:description" content="移行アシスタントは使えなかった． 旧Mac（MacBookAir）と接続して，直接移行することをトライ．（一回目は，MBAの方はEl Capitanだったが，二回目はアップグレードしてSeirra同士での移行） なぜだか最後，残り1時間40分から先に進めなくなる． ２回やってどちらもほぼ同じ症状（再現性あり）なので，ダメなのだろう． ということで，否応無く__手動インストール__を余儀なくされた． macOS sierraのクリーンインストール Cmd+rを押しながら起動．アップルマークが表示されたらCmd+rを離して良いみたい． ディスクユーティリティを開いてディスクを消去およびフォーマット OSの再インストール これ自体は時間は少々かかるが，スムーズに進む． Xcode App Storeからダウンロード． 一度Xcodeを起動して認証(?)しないと，のちのhomebrewインストールで引っかかる． Terminal.appの設定 Solarized から，ファイルをダウンロード． Terminal.appの環境設定「プロファイル」で，「読み込み...」からsolarizedの「Light」と「Dark …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="../../../../../posts/2017/01/31/move-to-new-macbookpro/index.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-01-31 22:54:48+09:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="../../../../../author/ryo-kobayashi.html">
<meta property="article:section" content="misc"/>
<meta property="article:tag" content="mac"/>
<meta property="og:image" content="http://ryokbys.web.nitech.ac.jp/contents/blog/images/yoda-and-me.png">

  <title>R.K.S. blog &ndash; 新しいMacBookProへの移行の記録</title>

</head>
<body>
  <aside>
    <div>
      <a href="../../../../..">
        <img src="http://ryokbys.web.nitech.ac.jp/contents/blog/images/yoda-and-me.png" alt="R.K.S. blog" title="R.K.S. blog">
      </a>
      <h1><a href="../../../../..">R.K.S. blog</a></h1>

<p>Live as if you were to die tomorrow. Learn as if you were to live forever.</p>
      <nav>
        <ul class="list">

          <!-- <li><a href="http://ryokbys.web.nitech.ac.jp/contents/blog/archives.html" target="_blank">Archives</a></li> -->
          <li><a href="http://ryokbys.web.nitech.ac.jp/contents/blog/archives.html" >Archives</a></li>
          <!-- <li><a href="http://ryokbys.web.nitech.ac.jp/contents/blog/tags.html" target="_blank">Tags</a></li> -->
          <li><a href="http://ryokbys.web.nitech.ac.jp/contents/blog/tags.html" >Tags</a></li>
        </ul>
      </nav>

      <ul class="social">
      </ul>
    </div>


  </aside>
  <main>


<article class="single">
  <header>
    <h1 id="move-to-new-macbookpro">新しいMacBookProへの移行の記録</h1>
    <p>
          Posted on Tue 31 January 2017 in <a href="../../../../../category/misc.html">misc</a>


    </p>
  </header>


  <div class="tag-cloud">
    <p>
      <a href="../../../../../tag/mac.html">mac</a>
    </p>
  </div>
  <div>
    <h2>移行アシスタントは使えなかった．</h2>
<p>旧Mac（MacBookAir）と接続して，直接移行することをトライ．（一回目は，MBAの方はEl Capitanだったが，二回目はアップグレードしてSeirra同士での移行）
なぜだか最後，残り1時間40分から先に進めなくなる．
２回やってどちらもほぼ同じ症状（再現性あり）なので，ダメなのだろう．
ということで，否応無く__手動インストール__を余儀なくされた．</p>
<h3>macOS sierraのクリーンインストール</h3>
<ol>
<li><code>Cmd+r</code>を押しながら起動．アップルマークが表示されたら<code>Cmd+r</code>を離して良いみたい．</li>
<li>ディスクユーティリティを開いてディスクを消去およびフォーマット</li>
<li>OSの再インストール</li>
</ol>
<p>これ自体は時間は少々かかるが，スムーズに進む．</p>
<h2>Xcode</h2>
<p>App Storeからダウンロード．
一度Xcodeを起動して認証(?)しないと，のちのhomebrewインストールで引っかかる．</p>
<h2>Terminal.appの設定</h2>
<p><a href="http://ethanschoonover.com/solarized">Solarized</a> から，ファイルをダウンロード．
Terminal.appの環境設定「プロファイル」で，「読み込み...」からsolarizedの「Light」と「Dark」を読み込んでおいた．
フォントサイズを11ptから14ptへ変更．
ウィンドウサイズも変更．</p>
<h2>Mailデータ移行</h2>
<p><a href="http://blog.skeg.jp/archives/2016/11/mail-backup-sierra.html">ここ</a>を参考にして，以下のファイル群を旧macからコピーした．</p>
<h3>インターネットアカウントの復元</h3>
<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">UserName</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Accounts</span>
</code></pre></div>


<h3>メールデータの復元</h3>
<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">kazuto</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Mail</span><span class="o">/</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">UserName</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Mail</span> <span class="n">Downloads</span><span class="o">/</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">UserName</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Containers</span><span class="o">/</span><span class="n">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">mail</span><span class="o">/</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">UserName</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Preferences</span><span class="o">/</span><span class="n">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">accounts</span><span class="p">.</span><span class="n">plist</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">UserName</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Preferences</span><span class="o">/</span><span class="n">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">accountsd</span><span class="p">.</span><span class="n">plist</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">UserName</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Preferences</span><span class="o">/</span><span class="n">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">mail</span><span class="o">-</span><span class="n">shared</span><span class="p">.</span><span class="n">plist</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">UserName</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Preferences</span><span class="o">/</span><span class="n">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">MailMigratorService</span><span class="p">.</span><span class="n">plist</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">UserName</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">SyncedPreferences</span><span class="o">/</span><span class="n">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">mail</span><span class="o">-</span><span class="n">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">mail</span><span class="p">.</span><span class="n">vipsenders</span><span class="p">.</span><span class="n">plist</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">UserName</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">SyncedPreferences</span><span class="o">/</span><span class="n">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">mail</span><span class="p">.</span><span class="n">plist</span>
</code></pre></div>


<p>キーチェーン（/Users/UserName/Library/Keychains）は，iCloudで同期されていれば，復元する必要なし．</p>
<h2>Emacs</h2>
<p>参考
<a href="http://keisanbutsuriya.hateblo.jp/entry/2016/04/10/115945">http://keisanbutsuriya.hateblo.jp/entry/2016/04/10/115945</a></p>
<div class="highlight"><pre><span></span><code>$ brew tap railwaycat/emacsmacport
$ brew install emacs-mac
$ brew linkapps
</code></pre></div>


<h3>設定ファイルのコピー</h3>
<p>旧macからemacs用の設定ファイルを転送する．</p>
<div class="highlight"><pre><span></span><code>$ rsync -avh /Volumes/kobayashi/.emacs.d ~/
</code></pre></div>


<h3>Caskのインストール</h3>
<div class="highlight"><pre><span></span><code>$ brew install cask
</code></pre></div>


<h3>ipython</h3>
<p>emacs起動時にipythonコマンドが見つからないと言われる場合は，pythonのインストールがまず必要．</p>
<h2>python</h2>
<p>pythonの新規インストール時にはプロジェクトごとにバージョンを切り替えられるpyenvをインストールしておいた方が良いらしい．</p>
<h3>pyenv</h3>
<p>どうもpyenvだとかvirtualenvだとかさまざまあるらしいが，ここではpyenvとvirtualenvプラグインをインストールする方法を採用する．下記参考．
<a href="http://cocodrips.hateblo.jp/entry/2014/09/02/171127">http://cocodrips.hateblo.jp/entry/2014/09/02/171127</a></p>
<div class="highlight"><pre><span></span><code>$ <span class="nv">CFLAGS</span><span class="o">=</span><span class="s2">&quot;</span><span class="s">-I$(xcrun --show-sdk-path)/usr/include</span><span class="s2">&quot;</span> <span class="nv">pyenv</span> <span class="nv">install</span> <span class="mi">2</span>.<span class="mi">7</span>.<span class="mi">13</span>
</code></pre></div>


<p><code>CFLAGS</code>を設定しないと，macOS sierraではうまいことインストールできない．
参考
<a href="http://kazscape.com/2014/12/kz-pythonインストール覚書/">http://kazscape.com/2014/12/kz-pythonインストール覚書/</a></p>
<p>どうも，anacondaというものをインストールすると，numpy，scipyだとかipython，jupyterなどがインストールされるらしくてかなり便利らしい．</p>
<div class="highlight"><pre><span></span><code>$ <span class="nv">CFLAGS</span><span class="o">=</span><span class="s2">&quot;</span><span class="s">-I$(xcrun --show-sdk-path)/usr/include</span><span class="s2">&quot;</span> <span class="nv">pyenv</span> <span class="nv">install</span> <span class="nv">anaconda</span><span class="o">-</span><span class="mi">4</span>.<span class="mi">0</span>.<span class="mi">0</span>
$ <span class="nv">pyenv</span> <span class="nv">versions</span>
  <span class="nv">system</span>
<span class="o">*</span> <span class="mi">2</span>.<span class="mi">7</span>.<span class="mi">13</span> <span class="ss">(</span><span class="nv">set</span> <span class="nv">by</span> <span class="o">/</span><span class="nv">Users</span><span class="o">/</span><span class="nv">kobayashi</span><span class="o">/</span>.<span class="nv">pyenv</span><span class="o">/</span><span class="nv">version</span><span class="ss">)</span>
  <span class="mi">3</span>.<span class="mi">5</span>.<span class="mi">3</span><span class="nv">rc1</span>
  <span class="nv">anaconda</span><span class="o">-</span><span class="mi">4</span>.<span class="mi">0</span>.<span class="mi">0</span>
$ <span class="nv">pyenv</span> <span class="nv">global</span> <span class="nv">anaconda</span><span class="o">-</span><span class="mi">4</span>.<span class="mi">0</span>.<span class="mi">0</span>
$ <span class="nv">pyenv</span> <span class="nv">versions</span>
  <span class="nv">system</span>
  <span class="mi">2</span>.<span class="mi">7</span>.<span class="mi">13</span>
  <span class="mi">3</span>.<span class="mi">5</span>.<span class="mi">3</span><span class="nv">rc1</span>
<span class="o">*</span> <span class="nv">anaconda</span><span class="o">-</span><span class="mi">4</span>.<span class="mi">0</span>.<span class="mi">0</span> <span class="ss">(</span><span class="nv">set</span> <span class="nv">by</span> <span class="o">/</span><span class="nv">Users</span><span class="o">/</span><span class="nv">kobayashi</span><span class="o">/</span>.<span class="nv">pyenv</span><span class="o">/</span><span class="nv">version</span><span class="ss">)</span>
</code></pre></div>


<p>とした．<code>CFLAGS</code>の設定がここでも必要かどうか知らないが，上で必要だったのだからおそらく必要だろう．</p>
<p>非常に便利なので<code>docopt</code>もインストールしておく．</p>
<div class="highlight"><pre><span></span><code>$ pip install docopt
</code></pre></div>


<h3>matplotlib.pyplotの問題</h3>
<p>このバージョンのmatplotlib (1.5.1)では，pyplotをimportしようとすると，下記のようなwarningが出て先に進まない（macOS Sierra 10.12.2）．</p>
<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">kobayashi</span><span class="o">/</span><span class="p">.</span><span class="n">pyenv</span><span class="o">/</span><span class="n">versions</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="p">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">font_manager</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">273</span><span class="p">:</span> <span class="n">UserWarning</span><span class="p">:</span> <span class="n">Matplotlib</span> <span class="k">is</span> <span class="n">building</span> <span class="n">the</span> <span class="n">font</span> <span class="k">cache</span> <span class="k">using</span> <span class="n">fc</span><span class="o">-</span><span class="n">list</span><span class="p">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="n">moment</span><span class="p">.</span>
  <span class="n">warnings</span><span class="p">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Matplotlib is building the font cache using fc-list. This may take a moment.&#39;</span><span class="p">)</span>
</code></pre></div>


<ul>
<li><a href="http://stackoverflow.com/questions/34771191/matplotlib-taking-time-when-being-imported">http://stackoverflow.com/questions/34771191/matplotlib-taking-time-when-being-imported</a></li>
<li><a href="http://stackoverflow.com/questions/17490444/import-matplotlib-pyplot-hangs">http://stackoverflow.com/questions/17490444/import-matplotlib-pyplot-hangs</a></li>
</ul>
<p>上記でいろいろと解決策が議論されているが，どれも自分の場合は有効でなかったため，下記のような対策をとった．これは<code>matplotlib/font_manager.py</code>を書き換えることになるので注意が必要．</p>
<p>これはどうも，上記<code>font_manager.py</code>の273行目</p>
<div class="highlight"><pre><span></span><code>        <span class="n">pipe</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;fc-list&#39;</span><span class="p">,</span> <span class="s1">&#39;--format=%{file}\\n&#39;</span><span class="p">],</span>
                                <span class="k">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span>
                                <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">)</span>
</code></pre></div>


<p>という箇所が問題なようだ．<code>%{file}</code>という部分がバグっているように思われる．
ここは，font-listを<code>fc-list</code>を用いて取得する部分なのだが，その部分をごっそり無視するため，
font_manager.py:325,326行目の</p>
<div class="highlight"><pre><span></span><code>            <span class="k">for</span> <span class="nv">f</span> <span class="nv">in</span> <span class="nv">get_fontconfig_fonts</span><span class="ss">(</span><span class="nv">fontext</span><span class="ss">)</span>:
                <span class="nv">fontfiles</span>[<span class="nv">f</span>] <span class="o">=</span> <span class="mi">1</span>
</code></pre></div>


<p>の部分をコメントアウトする．
別にこの部分がなくとも，その２〜３行前で十分にフォントリストは取得できていると期待できるので，大きな問題は生じないと期待する．（動かないよりは良い！）</p>
<h2>tmux</h2>
<p>端末仮想化コマンドらしい．いくつもの端末を起動しなくてもそれらを切り替えられ，通信が切れても後から復活できるらしい．かなり便利ツールで，unix/linuxユーザの間では常識ツールらしい．</p>
<ul>
<li><a href="http://kanjuku-tomato.blogspot.jp/2014/02/tmux.html">http://kanjuku-tomato.blogspot.jp/2014/02/tmux.html</a></li>
<li><a href="http://qiita.com/michiomochi@github/items/4bf8e34a91bbf3d9af20">http://qiita.com/michiomochi@github/items/4bf8e34a91bbf3d9af20</a></li>
</ul>
<h2>gnuplot</h2>
<p>XQuartzを先にインストールしなくてはいけない．
<a href="https://www.xquartz.org">https://www.xquartz.org</a>
その後，</p>
<div class="highlight"><pre><span></span><code>$ brew install gnuplot —with-x11
</code></pre></div>


<p>ここで，<code>--with-x11</code>というオプションを指定してx11を使うことを宣言してインストールしなくてはならない．</p>
<h2>iTunes</h2>
<p>参考
<a href="https://digitalfan.jp/103717">https://digitalfan.jp/103717</a></p>
<p><code>~/Music/</code>フォルダ内の「iTunes」フォルダを旧MacからコピーしてくればOK．</p>
<h2>LaTeX</h2>
<p><a href="http://qiita.com/hideaki_polisci/items/3afd204449c6cdd995c9">http://qiita.com/hideaki_polisci/items/3afd204449c6cdd995c9</a>
上記サイトに従ってインストールした．
今のところ問題なく動作しているように見える．</p>
<h2>homebrew-cask</h2>
<p>homebrewだけでなく，homebrew-caskというのも使うと，よりインストールが楽になるらしい</p>
<div class="highlight"><pre><span></span><code>$ brew install caskroom/cask/brew-cask
$ brew cask search
</code></pre></div>


<p>おそらく，unix系のコマンドラインだけでなく，ふつうのmac用アプリもこれでインストールできるようになるみたい．</p>
<h2>Google日本語入力</h2>
<p>OS標準のことえりを一ヶ月ほど試してみたが，やはりGoogle日本語入力の方が少々頭が良い．</p>
<p>Google日本語入力をダウンロードしてきて，インストールし，「キーボード」環境設定の「入力ソース」で</p>
<ul>
<li>ひらがな (Google)</li>
<li>英数 (Google)</li>
</ul>
<p>の２つを選択．Google入力ソースとして「カタカナ」，「半角カナ」，「全角英数」があるが，ほぼ使わないので入力ソースとして登録するよりは必要に応じて変換する方が良いと思う．</p>
<p>Emacsで <code>Control + Space</code> がマークセットに設定されている場合，これがOSのキーボードショートカットの「前の入力ソースを選択」とバッティングすると厄介なので，OSの設定を解除しておくとよい．</p>
  </div>




</article>

    <footer>
<p>&copy; Ryo KOBAYASHI </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36370521-4', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->



<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " R.K.S. blog ",
  "url" : "../../../../..",
  "image": "http://ryokbys.web.nitech.ac.jp/contents/blog/images/yoda-and-me.png",
  "description": ""
}
</script>
</body>
</html>